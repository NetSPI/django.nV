**Reviewer:** Amos Boldor

**Date:** February 5, 2017

**Reviewing:** nVisium Task Manager


----------------------

**Vulnerability 1: SQL Injection**

**Exposure:**

When uploading a file to a project you can pass in sql commands and it will execute of done right because they uplaod a file using raw sql

Views.py contained the problem.  You are able to repair the file by using the object relational manager to properly escape user input:

**Repair:**
```python
file_upload = File(name=name, path=upload_path, project=proj)
file_upload.save()
```

**Vulnerability 2: Broken Authentication**

**Exposure:**

You can manually give a user superuser status on registration. The was because of an incomplete list of excluded user attributes. 

**Repair:**

Forms.py contained the issue. I replaced the exclude value with a fields value, specifically listing the permitted form inputs. 
```python
fields = ('username', 'first_name', 'last_name', 'email', 'password')
```

**Vulnerability 4:** Cross-Site Scripting (XSS)

**Exposure:**

Code review exposed that several templates accessed the userâ€™s username with the safe method. This allowed to execute the username as code.

**Repair**

taskManager/base_backend.html and tutorials/base.html contained the vulnerable code. I removed the reference to the safe method.
Django can automatically add a header to configure clients browsers XSS protection to always block XSS attacks it detects. To do this set SECURE_BROWSER_XSS_FILTER to True
```python
{{ user.username|safe }}
to
{{ user.username }}
```
and
```python
SECURE_BROWSER_XSS_FILTER = True
```
